import{r as a,g,L as i,j as e,m,a as N,B as x,A as w,b as k,T as M,D as S,c as T,d as L,e as R,f as z,h as E,M as I,i as C,k as D,l as A,n as F,u as G}from"./index-CT1tCEI5.js";delete i.Icon.Default.prototype._getIconUrl;i.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-shadow.png"});const l={satellite:{name:"Satellite",url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",attribution:"Tiles &copy; Esri"},streets:{name:"Streets",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:"&copy; OpenStreetMap contributors"},terrain:{name:"Terrain",url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",attribution:"Tiles &copy; Esri"}},P=()=>{const[o,f]=a.useState([]),[r,d]=a.useState(null),[n,j]=a.useState("satellite"),h=a.useRef(null),s=a.useRef(null),u=a.useRef(null),p=a.useRef([]);a.useEffect(()=>{f(g())},[]),a.useEffect(()=>{if(!(!h.current||s.current))return s.current=i.map(h.current,{center:[20,0],zoom:2,zoomControl:!0,scrollWheelZoom:!0}),u.current=i.tileLayer(l[n].url,{attribution:l[n].attribution}).addTo(s.current),()=>{s.current&&(s.current.remove(),s.current=null)}},[]),a.useEffect(()=>{s.current&&(u.current&&u.current.remove(),u.current=i.tileLayer(l[n].url,{attribution:l[n].attribution}).addTo(s.current))},[n]),a.useEffect(()=>{s.current&&(p.current.forEach(t=>t.remove()),p.current=[],o.forEach(t=>{const c=i.marker([t.lat,t.lng]).addTo(s.current).bindPopup(`<div class="text-center"><p class="font-medium">${t.displayName}</p></div>`).on("click",()=>d(t));p.current.push(c)}))},[o]),a.useEffect(()=>{!s.current||!r||s.current.flyTo([r.lat,r.lng],12,{duration:1.5})},[r]);const y=t=>{F(t),f(g()),(r==null?void 0:r.id)===t&&d(null),G.success("Location removed from collection")},b=t=>{d(t)},v=()=>{d(null),s.current&&s.current.flyTo([20,0],2,{duration:1})};return e.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[e.jsxs(m.header,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"flex items-center justify-between p-4 border-b border-border",children:[e.jsx(N,{to:"/",children:e.jsxs(x,{variant:"ghost",className:"gap-2",children:[e.jsx(w,{className:"h-4 w-4"}),"Back"]})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(k,{className:"h-12 w-12"}),e.jsx("h1",{className:"font-display text-xl",children:"Collection"})]}),e.jsxs("div",{className:"flex items-center gap-2",style:{position:"relative",zIndex:20},children:[e.jsx(M,{}),e.jsxs(S,{children:[e.jsx(T,{asChild:!0,children:e.jsxs(x,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsx(L,{className:"h-4 w-4"}),l[n].name]})}),e.jsx(R,{align:"end",style:{zIndex:30},children:e.jsx(z,{value:n,onValueChange:t=>j(t),children:Object.entries(l).map(([t,{name:c}])=>e.jsx(E,{value:t,children:c},t))})})]})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col md:flex-row",children:[e.jsxs(m.aside,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"w-full md:w-80 border-b md:border-b-0 md:border-r border-border p-4 overflow-y-auto max-h-[40vh] md:max-h-none",children:[e.jsxs("h2",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide mb-4",children:["Saved Locations (",o.length,")"]}),o.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(I,{className:"h-10 w-10 mx-auto text-muted-foreground mb-3"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"No saved locations yet"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Save locations from game results to explore them here"})]}):e.jsx("div",{className:"space-y-2",children:e.jsx(C,{children:o.map(t=>e.jsxs(m.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,x:-20},className:`p-3 rounded-lg border cursor-pointer transition-colors ${(r==null?void 0:r.id)===t.id?"bg-primary/10 border-primary":"bg-card border-border hover:border-primary/50"}`,onClick:()=>b(t),children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:t.displayName}),t.country&&t.displayName!==t.country&&e.jsx("p",{className:"text-xs text-muted-foreground",children:t.country})]}),e.jsx(x,{variant:"ghost",size:"icon",className:"h-7 w-7 text-muted-foreground hover:text-destructive",onClick:c=>{c.stopPropagation(),y(t.id)},children:e.jsx(D,{className:"h-3.5 w-3.5"})})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2 text-xs text-muted-foreground",children:[e.jsx(A,{className:"h-3 w-3"}),e.jsxs("span",{children:[t.lat.toFixed(2),"째, ",t.lng.toFixed(2),"째"]})]})]},t.id))})})]}),e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("div",{ref:h,className:"h-full w-full min-h-[50vh]",style:{zIndex:0}}),r&&e.jsxs(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"absolute bottom-4 left-4 right-4 md:left-auto md:right-4 md:w-80 bg-card/95 backdrop-blur-sm border border-border rounded-lg p-4",children:[e.jsx("h3",{className:"font-display text-lg mb-1",children:r.displayName}),r.country&&r.displayName!==r.country&&e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:r.country}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[e.jsxs("span",{children:[r.lat.toFixed(4),"째, ",r.lng.toFixed(4),"째"]}),r.distanceKm!==void 0&&e.jsxs("span",{children:["Guessed within ",r.distanceKm<10?r.distanceKm.toFixed(1):Math.round(r.distanceKm)," km"]})]}),e.jsx(x,{variant:"ghost",size:"sm",className:"mt-3 w-full",onClick:v,children:"View All Locations"})]})]})]})]})};export{P as default};
